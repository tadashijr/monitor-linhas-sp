name: Monitor Linhas do Metrô SP

on:
  schedule:
    # Alertas das linhas 2,4,15 - Segunda a Sexta
    - cron: '0 10 * * 1-5'   # 07:00 BRT (segunda a sexta)
    - cron: '0 20 * * 1-5'   # 17:00 BRT (segunda a sexta)
  
  workflow_dispatch:  # Permite execução manual

jobs:
  verificar-linhas:
    runs-on: ubuntu-latest
    name: Verificar status das linhas
    
    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v3
      
      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Instalar dependências
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
      
      - name: Executar alerta das linhas 2,4,15
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
          ALERTAR_FALHA: ${{ secrets.ALERTAR_FALHA }}
          GITHUB_ACTIONS: true
          TIPO_ALERTA: 'linhas_especificas'
        run: |
          python main.py
